<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="4.LinuxC语言高级专题 &lt;朱有鹏&gt;, 博客制作,个人经验分享,嵌入式人,工智能等,Linux,C语言,c++,arm,qt">
    <meta name="description" content="4.LinuxC语言高级专题 &amp;lt;朱有鹏&amp;gt;第一节    4.1.内存这个大话题。4.1.1.程序运行为什么需要内存 14.1.1.1、计算机程序运行的目的计算机为什么需要编程？编程已经很多年了，已经写了很多程序，为什么还需要另外写">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>4.LinuxC语言高级专题 &lt;朱有鹏&gt; | 白子卿</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

    <link rel="stylesheet" href="/css/snow.css">
    <div id="snowzone">
    </div> 
    <script src="/js/snow.js"></script>

<meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="白子卿" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">白子卿</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="" class="waves-effect waves-light">

      
      <i class="fas fa-list" style="zoom: 0.6;"></i>
      
      <span>媒体</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a target="_blank" rel="noopener" href="https://baiziqing.github.io/">
          
          <i class="fas fa-music" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Musics</span>
        </a>
      </li>
      
      <li>
        <a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1hE411T7Nd?spm_id_from=333.999.0.0">
          
          <i class="fas fa-film" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Movies</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">白子卿</div>
        <div class="logo-desc">
            
            本站记录本人各种学习的旅途，用于巩固自我并启发后来人
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-list"></i>
			
			媒体
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a target="_blank" rel="noopener" href="https://baiziqing.github.io/ " style="margin-left:75px">
				  
				   <i class="fa fas fa-music" style="position: absolute;left:50px" ></i>
			      
		          <span>Musics</span>
                  </a>
                </li>
              
                <li>

                  <a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1hE411T7Nd?spm_id_from=333.999.0.0 " style="margin-left:75px">
				  
				   <i class="fa fas fa-film" style="position: absolute;left:50px" ></i>
			      
		          <span>Movies</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/article/wallhaven-v9dr6p.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">4.LinuxC语言高级专题 &lt;朱有鹏&gt;</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                          <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                          </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/c%E8%AF%AD%E8%A8%80/" class="post-category">
                                c语言
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-11-01
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2021-11-01
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    8.4k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    29 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        <!-- 代码块功能依赖 -->
        <script type="text/javascript" src="/libs/codeBlock/codeBlockFunction.js"></script>

        <!-- 代码语言 -->
        
        <script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>
        

        <!-- 代码块复制 -->
        
        <script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>
        

        <!-- 代码块收缩 -->
        
        <script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>
        

        <!-- 代码块折行 -->
        
        <style type="text/css">
        code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
        </style>
        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="4-LinuxC语言高级专题-lt-朱有鹏-gt"><a href="#4-LinuxC语言高级专题-lt-朱有鹏-gt" class="headerlink" title="4.LinuxC语言高级专题 <朱有鹏>"></a>4.LinuxC语言高级专题 &lt;朱有鹏&gt;</h1><h2 id="第一节-4-1-内存这个大话题。"><a href="#第一节-4-1-内存这个大话题。" class="headerlink" title="第一节    4.1.内存这个大话题。"></a>第一节    4.1.内存这个大话题。</h2><h3 id="4-1-1-程序运行为什么需要内存-1"><a href="#4-1-1-程序运行为什么需要内存-1" class="headerlink" title="4.1.1.程序运行为什么需要内存 1"></a>4.1.1.程序运行为什么需要内存 1</h3><h4 id="4-1-1-1、计算机程序运行的目的"><a href="#4-1-1-1、计算机程序运行的目的" class="headerlink" title="4.1.1.1、计算机程序运行的目的"></a>4.1.1.1、计算机程序运行的目的</h4><p>计算机为什么需要编程？编程已经很多年了，已经写了很多程序，为什么还需要另外写程序？计算机有这个新的目的是为了去运行到底为什么？<br>程序的目的为了去运行，程序运行是为了得到一定的结果。计算机就是用来计算的，所有的计算机程序其实都是在做计算。计算计算计算数据。<br>所以计算机程序中很重要的部分就是数据。<br><code>计算机程序 = 代码 + 数据</code>，就是说 代码 + 数据 （经过运行后） = 结果。</p>
<p>从宏观来理解，代码就是动作，就是加工数据的动作；数据就是数字就是代码加工的东西。<br>那么可以得到结论：程序运行的目的不外乎2个：结果、过程。</p>
<p>用函数类类比：函数的形参就是加工的数据（函数还需要一些临时数据，就是局部变量），函数本体就是就是代码，函数的返回值就是结果，函数体的执行过程就是过程。</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//这个函数的执行就是为了得到结果</span>
<span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> c<span class="token punctuation">;</span>
    c <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"c = %d\n"</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//这个函数的执行重在过程（重点在过程中的printf）返回值不需要。</span>
<span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> c<span class="token punctuation">;</span>
    c <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"c = %d\n"</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> c<span class="token punctuation">;</span>
<span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//这个函数又重结果又重过程。</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="4-1-1-2、计算机程序运行过程"><a href="#4-1-1-2、计算机程序运行过程" class="headerlink" title="4.1.1.2、计算机程序运行过程"></a>4.1.1.2、计算机程序运行过程</h4><p>计算机程序的运行过程，其实就是程序中很多个函数相续运行的过程。程序是由很多个函数组成的，程序的本质就是函数。函数的本质是加工数据的动作。</p>
<h4 id="4-1-1-3、冯诺依曼结构和哈佛结构"><a href="#4-1-1-3、冯诺依曼结构和哈佛结构" class="headerlink" title="4.1.1.3、冯诺依曼结构和哈佛结构"></a>4.1.1.3、冯诺依曼结构和哈佛结构</h4><p><code>冯诺依曼结构：数据和代码放在一起。</code><br><code>哈佛结构：      数据和代码分开存在。</code><br>什么是代码：  函数。<br>什么是数据：  全局变量、局部变量。            </p>
<p>在s5pv210中运行Linux系统上，运行应用程序时：这时所有的应用程序的代码和数据都是DRAM，<br>所以这种结构就是冯诺依曼结构：在单片机中，我们把程序代码烧写到flash（norflash）中，然后程序在flash中原地运行，<br>程序中所涉及到的数据（全局变量、局部变量）不能放在flash中，必须放在RAM（SRAM）中，这种就叫哈佛结构。            </p>
<h4 id="4-1-1-4、动态内存DRAM和静态内存SRAM"><a href="#4-1-1-4、动态内存DRAM和静态内存SRAM" class="headerlink" title="4.1.1.4、动态内存DRAM和静态内存SRAM"></a>4.1.1.4、动态内存DRAM和静态内存SRAM</h4><p><code>DRAM是动态内存，SRAM是静态内存</code>，详细细节自己百度</p>
<h4 id="4-1-1-5、总结：为什么需要内存呢"><a href="#4-1-1-5、总结：为什么需要内存呢" class="headerlink" title="4.1.1.5、总结：为什么需要内存呢"></a>4.1.1.5、总结：为什么需要内存呢</h4><p>内存是用来储存可变数据的，数据在程序中表现为全局变量、局部变量（在gcc中，其实常量也是储存在内存中的）（单片机中大部分，<code>常量是储存在flash中的，也就是在代码段</code>），对我们来说非常重要，对程序运行更是本质相关。</p>
<p>所以内存对程序来说几乎是本质需求，越简单的程序需要越少内存，而庞大复杂的程序需要更多的内存。内存管理是我们写程序时很重要的话题。<br>我们之前学过的了解过的很多程序的关键其实都是为了内存，比如说数据结构（数据结构是研究数据如何组织的，数据放在内存中）和算法（算法是为了用更优秀更有效的方法来加工数据，既然跟数据有关就离不开内存）。</p>
<h4 id="4-1-1-6、深入思考：如何管理内存（无os时，有os时）"><a href="#4-1-1-6、深入思考：如何管理内存（无os时，有os时）" class="headerlink" title="4.1.1.6、深入思考：如何管理内存（无os时，有os时）"></a>4.1.1.6、深入思考：如何管理内存（无os时，有os时）</h4><p>对于计算机来说，内存容量越大则可能性越大，所以大家都希望自己电脑内存更大。<br>我们写程序时，如何管理内存？如果管理不善，可能会造成程序运行消耗过多内存，这样迟早内存都被你这个程序吃光了，当没有内存时程序就会奔溃。所以内存对程序来说是一种资源，所以管理内存对程序来说是从一个重要技术和话题。</p>
<p><strong>先从操作系统角度来讲：</strong><br>操作系统掌握所有的硬件内存，因为内存很大，所以操作系统把内存分成一个一个的页面（其实就是一块，一般4kb），然后以页面为单位来管理。<br>页面内用更细小的方式来以字节单位管理。操作系统内存管理的原理非常麻烦、非常复杂、非常不人性化。那么对我们这些使用操作系统的人来说，其实不需要了解这些细节。操作系统为我们提供了内存管理的一些接口，我们只需要用API即可管理内存。<br>比如说在C语言中使用malloc free这些接口来管理内存。</p>
<p><strong>没有操作系统时：</strong>在没有操作系统（其实就是裸机程序）中，程序需要直接操作内存，编程者需要自己计算内存的使用和安排。<br>如果编程者不小心把内存用错了，错误结果需要自己承担。            </p>
<p><strong>再从语言角度来讲：</strong>不同的语言提供了不同的操作内存接口。<br>比如汇编：根本没有任何内存管理，内存管理全靠程序员自己，汇编中操作内存直接使用内存地址（比如 0xd0020010），非常麻烦：<br>比如C语言：C语言中编译器帮我们管理直接内存地址，我们都是通过编译器提供的变量名等来访问内存的，操作系统下如果需要大块内存，可以通过API（mallocfree）来访问系统内存。裸机程序中需要大块的内存需要自己来定义数组来解决。</p>
<p><strong>比如c++语言：</strong>c++语言对内存的使用进一步封装。我们可以用new来创建对象（其实就是为对象分配内存），然后使用完了用deldete来删除对象（其实就是释放内存）。<br>所以c++语言对内存的管理比c要高级一些，容易一些，但是c++中内存的管理还是靠程序员自己来做。<br>如果程序员new了一个对象，但是完了忘记deldete就会造成这个对象占用的内存不能释放，这就是内存泄漏。</p>
<p><strong>java/c#等语言：</strong>这些语言不直接操作内存，而是通过虚拟机来操作内存。这样虚拟机作为我们程序员的代理，来帮我们处理内存的释放工作。<br>如果我的程序申请了内存，忘记了释放，虚拟机帮我们释放内存。听起来视乎c#/ava等语言比c/c++有优势，但是这个虚拟机回收内存是需要一定的代价的。<br>所以语言没有好坏，只有适应不适用。当我们程序对性能非常在乎的时候（操作系统内核）就会用c/c++语言；当我们对开发程序的速度非常在乎的时候，就会用java/C#语言。        </p>
<p>​                            </p>
<h3 id="4-1-2-程序运行为什么需要内存-2"><a href="#4-1-2-程序运行为什么需要内存-2" class="headerlink" title="4.1.2.程序运行为什么需要内存 2"></a>4.1.2.程序运行为什么需要内存 2</h3><p>同上：</p>
<h3 id="4-1-3-位、字节、半字、字的概念和内存位宽"><a href="#4-1-3-位、字节、半字、字的概念和内存位宽" class="headerlink" title="4.1.3.位、字节、半字、字的概念和内存位宽"></a>4.1.3.位、字节、半字、字的概念和内存位宽</h3><h4 id="4-1-3-1-什么是内存？（硬件和逻辑两个角度）"><a href="#4-1-3-1-什么是内存？（硬件和逻辑两个角度）" class="headerlink" title="4.1.3.1.什么是内存？（硬件和逻辑两个角度）"></a>4.1.3.1.什么是内存？（硬件和逻辑两个角度）</h4><p><strong>从硬件角度：</strong>内存实际上是电脑的一个配件（一般叫内存条）。<br>根据不同的硬件实现的原理分为SRAM和DRAM（DRAM又有好多代，比如更早的SDRAM，后来DDR1、DDR2、…LPDDR）。                </p>
<p><strong>从逻辑角度：</strong>内存是这样一种东西，它可以随机访问（随机访问的意思是只要给一个地址，就可以访问这个内存地址）、并且可以读写（当然了逻辑上也可以限制其为只读者只写）；内存在编译中天然是用来存放变量的（就是因为有了内存，C语言才能定义变量，C语言中的一个变量，实际就对应内存中的一个单元）。</p>
<h4 id="4-1-3-2-内存的逻辑抽象图（内存的编程模型）内存"><a href="#4-1-3-2-内存的逻辑抽象图（内存的编程模型）内存" class="headerlink" title="4.1.3.2.内存的逻辑抽象图（内存的编程模型）内存"></a>4.1.3.2.内存的逻辑抽象图（内存的编程模型）内存</h4><p><strong>从逻辑角度上讲：</strong>内存实际上是由无数个内存单元组成的，每个单元格有一个固定的地址叫内存地址，这个地址和这个内存单元唯一对应且永久绑定。<br>以大楼来类比内存是最合适的。逻辑上的内存就好像是一栋大楼，内存的单元格就好像大楼中的一个个小房间，每个单元格地址就好像一个个小房间的房间号。<br>内存中储存内容就好像住在房间中的人一样。</p>
<p><strong>逻辑上讲</strong>：内存可以无限大（因为数学上的编号永远可以增加，无尽头）。但是现实中，实际内存是有限制的，比如32位的系统（32系统指定是32位数据线，一般地址也是32位，这个地址32位决定内存做32位二进制，逻辑上大小为2的32次方）内存限制就为4G。<br>实际上32位系统中可以用的内存小于4G的（比如32位CPU装32位windows，实际上内存只有512M）。            </p>
<h4 id="4-1-3-2-位和字节"><a href="#4-1-3-2-位和字节" class="headerlink" title="4.1.3.2.位和字节"></a>4.1.3.2.位和字节</h4><p>内存单元的大小单位有4个：<code>位（1bit）、字节（8bit）、半字（一般是16bit）、字（一般是32bit）</code>。<br>在所以计算机，所以的机器中（不管16、32、64位系统），<code>永远都是1bit，字节永远是8bit。</code>        </p>
<h4 id="4-1-3-4-字和半字"><a href="#4-1-3-4-字和半字" class="headerlink" title="4.1.3.4.字和半字"></a>4.1.3.4.字和半字</h4><p>历史上曾经出现过16位、32位、64位系统三种，而且操作系统还有windoes、Linux、ios、等很多，所以很多的概率在历史上曾经被混乱的定义过。<br>建议大家对字、半字、双字这些概念不要详细区分，只要知道这些单位具体有多少位是依赖平台的。<br>实际工作中每种平台先去搞清楚这些平台的定义（字是多少位，半字永远是字的一半、双字永远是字的2倍大小）。                </p>
<p>编程时一般用不到字这个概念，那我们区分这个概念主要是因为有些文档中会用到这些概念，如果不区分可能对你程序的误解。<br>在Linux + ARM 这个硬件平台上（我们嵌入式核心课的所有课程中），字是32位的。</p>
<h4 id="4-1-3-5-内存位宽（硬件和逻辑两个角度）"><a href="#4-1-3-5-内存位宽（硬件和逻辑两个角度）" class="headerlink" title="4.1.3.5.内存位宽（硬件和逻辑两个角度）"></a>4.1.3.5.内存位宽（硬件和逻辑两个角度）</h4><p><strong>从硬件角度讲：</strong>硬件内存的实现本身是有宽度的，也就是说有些内存条就是8位的，而有些就是16位的。<br>那么需要强调的是内存芯片之间是可以并联的，可以通过并联即使8位的内存芯片也可以做出来16位或32位的硬件内存。</p>
<p><strong>从逻辑角度讲：</strong>内存位宽在逻辑上是任意的，甚至逻辑上存在位宽是24位的内存（但是实际上这种硬件是买不到的，也没有实际意义）。<br>从逻辑角度来讲不管内存位宽是多少，我就直接操作即可，对我的操作不构成影响。但是因为你的操作不是纯逻辑而是需要硬件去执行的，所以不能为所欲为，<br>所以我们实际的很多操作都是受限于硬件的特性的。譬如24位的内存逻辑上和32位的内存没有任何区别，但实际硬件都是32位的，都要按照32位硬件的特性和限制来干活。</p>
<h3 id="4-1-4-内存编址和寻址、内存对齐"><a href="#4-1-4-内存编址和寻址、内存对齐" class="headerlink" title="4.1.4.内存编址和寻址、内存对齐"></a>4.1.4.内存编址和寻址、内存对齐</h3><h4 id="4-1-4-1、内存编址方法"><a href="#4-1-4-1、内存编址方法" class="headerlink" title="4.1.4.1、内存编址方法"></a>4.1.4.1、内存编址方法</h4><p>内存在逻辑上就是一个一个格子，这些格子可以用来装东西（里面装的东西就是内存中存储的数），每个格子有一个编号，这个编号就是内存地址，这个内存地址（一个数）和这个格子的空间（实质上是一个空间）是一一对应永久绑定的。这就是内存编址的方法。<br>在程序运行时，计算机CPU实际只认识内存地址，而不关心这个地址所代表的空间在哪里，怎么分布这些实体问题。因为硬件设计保证了按照这个地址就一定能找到这个格子，所以说内存单元的2个概念：<code>地址和空间是内存单元的两个方面。</code>        </p>
<h4 id="4-1-4-2、关键：内存编址是以字节为单位的"><a href="#4-1-4-2、关键：内存编址是以字节为单位的" class="headerlink" title="4.1.4.2、关键：内存编址是以字节为单位的"></a>4.1.4.2、关键：内存编址是以字节为单位的</h4><p>我随便给一个数字（7），然后说这个数是一个内存地址，然后问你这个地址对应空间多大？<br>这个大小是固定的，就是一个字节（8bit）。</p>
<p>如果把内存比喻一栋大楼，那么这个楼的一个一个内存格子，这个格子的大小是固定的8bit，就好像这个大楼里面所有的房间户型是一样的。        </p>
<h4 id="4-1-4-3、内存和数据类型的关系"><a href="#4-1-4-3、内存和数据类型的关系" class="headerlink" title="4.1.4.3、内存和数据类型的关系"></a>4.1.4.3、内存和数据类型的关系</h4><p><code>C语言中基本数据类型有： char short int long float double 。</code><br>int 整型（整数类型，这个整就体现它和CPU本身的数据位宽是一样的）比如32位的CPU，整型就是32位，int就是32位。<br><strong>数据类型和内存关系在于:</strong><br>数据类型是来定义变量的，而这些变量需要存储、运算在内存中。所以说数据类型必须和内存相匹配才能获得最好性能，否则可能不工作或者效率低下。</p>
<p><code>在32位系统中定义变量最好用int，因为这样效率高</code>，原因就在于32位系统本身配合内存也是32位，这样的硬件配置天生适合定义32位int类型变量，效率最高。    ***<br>也能定义8位的char类型变量或者16位short类型变量，但是实际上访问效率不高。</p>
<p>在很多32位环境下，我们实际定义boll类型变量（实际只需要1个bit就够了）都是用int来实现boll的。也就是说我们定义一个boll b1时，编译器实际帮我们分配了32位的内存来储存这个boll变量b1，编译器实际上浪费了31位内存，但是好处是效率高。</p>
<p>问题：实际编程时要以内存为大还是运行效率为重？答案是不定的，看具体情况。<br>很多年前，内存很贵，那时写代码以省内存为主。现在随着半导体的发展内存变得便宜，现在的机器都是高配，不在乎省一点内存，而效率和用户体验变成了关键。<br><code>所以现在写程序以效率为重。</code>                </p>
<h4 id="4-1-4-4、内存对齐"><a href="#4-1-4-4、内存对齐" class="headerlink" title="4.1.4.4、内存对齐"></a>4.1.4.4、内存对齐</h4><p>在c中 int a; 定义一个int 类型变量，在内存中必须分配4字节来储存这个a。有那么2种不同内存分配思路和策略：<br>第一种： 0 1 2 3                                        //对齐访问<br>第二种： 1 2 3 4    或者 2 3 4 5    或者 3 4 5 6         //非对齐访问<br>内存的对齐访问不是逻辑的问题，是硬件的问题。从硬件角度来说，32位内存它 0 1 2 3 四个单元本身逻辑上就有相关性，这4字节组合起来当作一个 int 硬件上合适，效率就高。</p>
<p><code>对齐访问很对齐硬件，所以效率高；非对齐访问因为和硬件本身不搭配，所以效率不高。</code>（因为兼容性的问题，一般硬件也都提供非对齐访问，但是效率要低很多。）    </p>
<h4 id="4-1-4-5、从内存编址看数组的意义。"><a href="#4-1-4-5、从内存编址看数组的意义。" class="headerlink" title="4.1.4.5、从内存编址看数组的意义。"></a>4.1.4.5、从内存编址看数组的意义。</h4><p>0 1 2 3定义的是32位系统的地址，不是数组。<br>元素    {0 1 2 3}        括号里面的就是元素<br>首地址     0 1 2 3         0 就是数组首地址</p>
<h3 id="4-1-5-C语言如何操作内存"><a href="#4-1-5-C语言如何操作内存" class="headerlink" title="4.1.5.C语言如何操作内存"></a>4.1.5.C语言如何操作内存</h3><h4 id="4-1-5-1、C语言对内存地址的封装（用变量名来访问内存、数据类型的含义、函数名的含义）"><a href="#4-1-5-1、C语言对内存地址的封装（用变量名来访问内存、数据类型的含义、函数名的含义）" class="headerlink" title="4.1.5.1、C语言对内存地址的封装（用变量名来访问内存、数据类型的含义、函数名的含义）"></a>4.1.5.1、C语言对内存地址的封装（用变量名来访问内存、数据类型的含义、函数名的含义）</h4><p>比如在C语言中 int a; a = 5; a += 4;            //a == 9</p>
<p><strong>结合内存来解析C语言语句的本质：</strong>        ***<br>int a;    //编译器帮我们申请了一个int类型的内存格子（长度是4字节，地址只有编译器知道，地址是确定的），并且把符号a和这个格子。<br>a = 5;    //编译器发现我们要给a赋值，就会把这个值5丢到符号a绑定的那个内存格子中。<br>a += 4;    //编译器发现我们要给a赋值，a += a 等效于 a = a + 4; 编译器会把a原理的值读出来，然后给这个值 +4 ,再把之后的和写入a里面去。</p>
<p>C语言中数据类型的本质含义是：表示一个内存格子长度和解析方法。    </p>
<p>数据类型决定长度含义：我们一个内存地址（0x30000000），本来这个地址只代表1字节的长度，但是实际上我们可以通过给他一个类型(int)，让他有了长度(4)，这样这个代表内存地址的数字（0x30000000）就表示从这个数字（0x30000000）开头的连续的n(4)个字节的内存格子了 （ 0x30000000 + 0x30000001 + 0x30000002 + 0x30000003）。            </p>
<p>数据类型决定解析方法的含义：比如我们有一个内存地址（0x30000001），我们可以通过给这个内存地址不同的类型指定这个内存单元格子中二进制数的解析方法。<br>比如我 (int)0x30000000,含义就是（ 0x30000000 + 0x30000001 + 0x30000002 + 0x30000003 ）这4个字节连起来共同储存的是一个int型数据；那么我（float）0x30000000，含义就是（ 0x30000000 + 0x30000001 + 0x30000002 + 0x30000003 ）这4个字节连起来共同储存的是一个float型数据。<br>之前讲的一个很重要的概念：<code>内存单元格子的编址单位是字节。</code><br>(int *)0;<br>(float *)0;<br>(short)0;<br>(char)0;</p>
<p>int a;        //int a;时编译器会自动给a分配一个内存地址，比如说是0x12345678<br>(int *)a;    //等价于(int *)0x12345678<br>(float *)a;</p>
<p>C语言中，函数就是一段代码的封装。函数名的实质就是这一段代码的首地址。所以说函数名的本质也是一个内存地址。    </p>
<h4 id="4-1-5-2、用指针来间接访问内存"><a href="#4-1-5-2、用指针来间接访问内存" class="headerlink" title="4.1.5.2、用指针来间接访问内存"></a>4.1.5.2、用指针来间接访问内存</h4><p>关于这个类型，（不管是普通变量类型 int float 等，还是指针类型 int *     float * 等），只要记住：<br>类型只是对后面数字或者符号（代表的是内存地址）所表征的内存一种长度规定和解析方法规定而已。</p>
<p>C语言中的指针，全名叫指针变量，指针变量和普通变量没有任何区别。比如数 int a 和 int *p 其实没有任何区别，a和b都代表一个内存地址（比如是0x20000000），但是这个内存地（0x20000000）的长度和解析方法不同。<br>a是 int 型所以a的长度是4字节，解析方法是按照int的规定来的；p是int *类型，所以长度是4字节，解析方法是int *来规定的（0x20000000开头的连续4字节存储了1个地址，这个地址所代表的内存单元存放的是一个int类型的数）。                                    </p>
<h4 id="4-1-5-3、指针类型的含义"><a href="#4-1-5-3、指针类型的含义" class="headerlink" title="4.1.5.3、指针类型的含义"></a>4.1.5.3、指针类型的含义</h4><p>同上：</p>
<h4 id="4-1-5-4、用数组来管理内存"><a href="#4-1-5-4、用数组来管理内存" class="headerlink" title="4.1.5.4、用数组来管理内存"></a>4.1.5.4、用数组来管理内存</h4><p>数组管理内存和变量其实没有本质的区别，只是符号的解析方法不同。（普通变量、数组、指针变量其实都没有本质差别，都是对内存地址的解析，只是解析的方法不一样）。</p>
<p>int a;        //编译器分配4字节给a，并且把首地址和符号a绑定起来。<br>int b[10];    //编译器分配40个字节长度给b，并且把首元素    </p>
<p>数组中第一个元素（a[0]）就称为首元素：每一个元素元素类型都是int，所以长度都是4，其中第一个字节就称为首地址；首元素a[0]的首地址就称为首元素的首地址。        </p>
<h3 id="4-1-6-内存管理之结构体"><a href="#4-1-6-内存管理之结构体" class="headerlink" title="4.1.6.内存管理之结构体"></a>4.1.6.内存管理之结构体</h3><h4 id="4-1-6-1、数据结构这门学问的意义。"><a href="#4-1-6-1、数据结构这门学问的意义。" class="headerlink" title="4.1.6.1、数据结构这门学问的意义。"></a>4.1.6.1、数据结构这门学问的意义。</h4><p>简单来说，就是研究数据如何组织（在内存中排布），如何加工的学问。</p>
<h4 id="4-1-6-2、最简单的数据结构：数组"><a href="#4-1-6-2、最简单的数据结构：数组" class="headerlink" title="4.1.6.2、最简单的数据结构：数组"></a>4.1.6.2、最简单的数据结构：数组</h4><p>为什么要有数组？因为程序中有好多个类型相同、意义相关的变量需要管理，这时如果用单独变量来做程序看起来比较乱，用数组来会更好的管理。<br>比如 int ages[20];</p>
<h4 id="4-1-6-3、数组的优劣和缺陷。"><a href="#4-1-6-3、数组的优劣和缺陷。" class="headerlink" title="4.1.6.3、数组的优劣和缺陷。"></a>4.1.6.3、数组的优劣和缺陷。</h4><p><code>优势：数组比较简单，访问用下标来访问，可以随机访问。 缺陷：数组元素类型必须相同；数组的大小必须在定义时给出一但确定大小不能改变。</code>        </p>
<h4 id="4-1-6-4、结构体隆重登场。"><a href="#4-1-6-4、结构体隆重登场。" class="headerlink" title="4.1.6.4、结构体隆重登场。"></a>4.1.6.4、结构体隆重登场。</h4><p>结构体发明处理就是为了解决数组第一个缺陷；所有元素必须相同<br>我们要管理3个学生的年龄（int类型），怎么办。<br>第一种解法：数组    int ages[3];<br>第二种解法：结构体。</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">struct</span> ages
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> age1<span class="token punctuation">;</span>
    <span class="token keyword">int</span> age2<span class="token punctuation">;</span>
    <span class="token keyword">int</span> age3<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> ages age<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>分析总结:在这个示例中，数组比结构体好。但是不能得出结论数组比结构体好，在元素类型不同时只能使用结构体而不能使用数组。</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">struct</span> pople
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> age<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//年龄</span>
    <span class="token keyword">int</span> name<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//姓名</span>
    <span class="token keyword">int</span> height<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//身高</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> ages age<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="4-1-6-5、题外话：结构体内嵌指针实现面向对象。"><a href="#4-1-6-5、题外话：结构体内嵌指针实现面向对象。" class="headerlink" title="4.1.6.5、题外话：结构体内嵌指针实现面向对象。"></a>4.1.6.5、题外话：结构体内嵌指针实现面向对象。</h4><p><strong>面向过程与面向对象。</strong><br>总的来说：C语言是面向过程的，但是C语言写出的Linux系统是面向对象的。<br>非面向对象语言，不一定不能实现面向对象的代码。只是说用面向对象的语言来实现面向对象更加简单一些，直观一些，无脑一些。</p>
<p>用c++、java 等面向对象的语言来实现面向对象简单一些，因为语言本身帮我们做了很多事情；但是c来实现面向对象很麻烦，看起来也不容易理解，这是为什么大多数学过C语言却看不懂Linux内核代码原因。            </p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">struct</span> sbrk
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> age<span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//普通变量</span>
    <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>pFunc<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//函数指针，指向void (*pFunc)(void)这类的函数。</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>使用这样结构体就可以实现面向对象。<br>这样包含了函数指针结构体，类似于面向对象中的class，结构体中变量类似于class的成员变量，结构体中的函数指针类似于class中成员方法。</p>
<h3 id="4-1-7-内存管理之栈"><a href="#4-1-7-内存管理之栈" class="headerlink" title="4.1.7.内存管理之栈"></a>4.1.7.内存管理之栈</h3><h4 id="4-1-7-1、什么是栈。"><a href="#4-1-7-1、什么是栈。" class="headerlink" title="4.1.7.1、什么是栈。"></a>4.1.7.1、什么是栈。</h4><p><code>栈是一种数据结构，C语言中使用栈来保存局部变量。栈是被发明出来管理内存的。    </code>    </p>
<h4 id="4-1-7-2、栈管理内存的特点（小内存，自动化）。"><a href="#4-1-7-2、栈管理内存的特点（小内存，自动化）。" class="headerlink" title="4.1.7.2、栈管理内存的特点（小内存，自动化）。"></a>4.1.7.2、栈管理内存的特点（小内存，自动化）。</h4><p><strong>栈的特点：</strong><code>先进后出</code>    FILO     first in last out    栈入口即出口，只有一个口，另一口是堵死的。所以先进去必须后出来。<br><strong>队列特点：</strong><code>先进先出</code>    FIFP     first in first out    队列入口和出口都有，必须从入口进去，出口出来，先进去必须先出来，否则就堵住后面的。    </p>
<h4 id="4-1-7-3、栈的应用举例：局部变量。"><a href="#4-1-7-3、栈的应用举例：局部变量。" class="headerlink" title="4.1.7.3、栈的应用举例：局部变量。"></a>4.1.7.3、栈的应用举例：局部变量。</h4><p>C语言中的局部变量就是栈实现的，我们定义一个局部变量（int a），编译器会在栈中分配一段空间（4字节）给这个局部变量用（分配时栈顶指针会移动给出空间，给局部变量a用的意思就是，将这4字节的栈内存的内存地址和我们定义的局部变量a给关联起来）。</p>
<p><strong>注意：</strong>这里栈指针移动和内存分配是自动的（栈自己完成，不用我们写代码去操作），然后等我们函数退出时，局部变量要消亡。对应的栈的操作是弹栈（出栈）。<br>出栈时也是栈顶指针移动将栈空间中与a关联的那4个字节空间释放。这个动作也是自动的，也不用写代码干预。</p>
<p><strong>栈的优点：</strong><code>栈管理内存，好处是方便，分配和最后回收都不要程序员操心，C语言自动完成。</code>        ***</p>
<p><strong>分析一个细节：</strong>C语言中，定义局部变量未初始化，值是随机的，为什么？<br>定义局部变量，其实就是栈中通过移动栈指针来给程序提供一个内存空间和这个局部变量名绑定。因为这段内存空间在栈上，而栈内存是反复使用的（脏的，上次用完没清零的），所以说使用栈来实现的局部变量定义时如果不显示初始化，值就是脏的。如果你显示初始化怎么样？<br>C语言是通过一个小手段来实现局部变量的初始化。<br>int a = 15;        //局部变量定义时初始化<br>C语言编译器自动转成：<br>int a;            //局部变量定义<br>a = 15;            //普通赋值语句                                                </p>
<h4 id="4-1-7-4、栈的约束（预定栈的大小不灵活，怕溢出）。"><a href="#4-1-7-4、栈的约束（预定栈的大小不灵活，怕溢出）。" class="headerlink" title="4.1.7.4、栈的约束（预定栈的大小不灵活，怕溢出）。"></a>4.1.7.4、栈的约束（预定栈的大小不灵活，怕溢出）。</h4><p><code>首先栈是有长度的。所以栈内存不太灵活，如果太小怕溢出，太大怕浪费内存。</code>（这个特点有点像数组）        ***<br>栈的溢出危害很大，一定要避免。所以我们在C语言中定义局部变量时，不能太多，太大（不能定义局部变量如：int a[10000]；使用递归解决问题时一定要注意收敛）。</p>
<h3 id="4-1-8-内存管理之堆"><a href="#4-1-8-内存管理之堆" class="headerlink" title="4.1.8.内存管理之堆"></a>4.1.8.内存管理之堆</h3><h4 id="4-1-8-1、什么是堆。"><a href="#4-1-8-1、什么是堆。" class="headerlink" title="4.1.8.1、什么是堆。"></a>4.1.8.1、什么是堆。</h4><p>堆（heap）是一种内存管理方式。内存管理对操作系统来说是很复杂的事情，因为内存容量很大，其次内存需求在时间和大小块没有规律（操作系统运行着几十，几百，几千个进程随时都会申请或者释放内存，申请需求在时间和大小块上没有随意）。</p>
<p><code>堆这种内存管理方式特点就是自由（随时申请，释放；大小块随意）。</code>堆内存是操作系统规划给堆管理器（操作系统中的一段代码，属于操作系统的内存管理单元）来管理，然后向使用者（用户进程）提供API（malloc和free）来使用堆内存。</p>
<p>我们什么时候需要使用堆内存？<br>需要内存容量比较大，需要反复使用和释放时，需要反复使用及释放时，很多数据结构（如链表）的表现都要使用堆内存。<br>int a[10000]；</p>
<h4 id="4-1-8-2、堆管理内存的特点（大块内存、手工分配-amp-使用-amp-释放）。"><a href="#4-1-8-2、堆管理内存的特点（大块内存、手工分配-amp-使用-amp-释放）。" class="headerlink" title="4.1.8.2、堆管理内存的特点（大块内存、手工分配&amp;使用&amp;释放）。"></a>4.1.8.2、堆管理内存的特点（大块内存、手工分配&amp;使用&amp;释放）。</h4><p><strong>特点一：</strong>容量不限（常规使用的需求容量都能满足）</p>
<p><strong>特点二：</strong>申请和释放都需要手工进行（需要程序员写代码明确申请malloc及释放free）。如果程序员申请内存使用未释放，这段内存就丢失了（在堆管理器的记录中，这段内存任然属于你这个进程，但是进程自己又以为这段内存已经不用了，再用的时候又去申请新的内存块，这就叫吃内存），称为内存泄漏。在c/c++语言中，内存泄漏是严重的程序bug，这也是别人认为java/c#等语言比c/c++优秀的地方。        </p>
<h4 id="4-1-8-3、C语言操作堆内存的接口（malloc-free）。"><a href="#4-1-8-3、C语言操作堆内存的接口（malloc-free）。" class="headerlink" title="4.1.8.3、C语言操作堆内存的接口（malloc free）。"></a>4.1.8.3、C语言操作堆内存的接口（malloc free）。</h4><p><code>堆内存释放时简单，直接free释放即可。    void free(void *ptr);</code><br><code>堆申请内存时，有3个可选择的类似功能的函数：malloc，calloc，realloc</code><br>void *malloc(size_t size);<br>void *calloc(size_t nmemb, size_t size);    //nmemb个单元，每个单元size字节<br>void *realloc(void *ptr, size_t size);        //改变原来申请空间大小的。</p>
<p>比如申请10个int元素的内存：<br>malloc(40);        malloc(10*sizeof(int));<br>calloc(10,4);    calloc(10,sizeof(int));        </p>
<p>数组在定义时必须同时给出数组元素个数（数组大小），而且一旦定义再无法更改。在Java等高级语言中，一些语法技巧可以更改数组大小，但其实这只是一种障眼法。<br>他的工作原理是：先重新创建一个新的数组大小为要更改的数组，然后将原数组的所有元素复制进新的数组，然后释放原数组，最后返回新的数组给用户。</p>
<p>堆内存申请时必须给定大小，然后一旦申请完成大小不变，如果要变只能通过realloc接口。realloc的实现原理类似于java中的可变大小数组的方式。                        </p>
<h4 id="4-1-8-4、堆的优势和劣势（管理大块内存、灵活、容易内存泄漏）。"><a href="#4-1-8-4、堆的优势和劣势（管理大块内存、灵活、容易内存泄漏）。" class="headerlink" title="4.1.8.4、堆的优势和劣势（管理大块内存、灵活、容易内存泄漏）。"></a>4.1.8.4、堆的优势和劣势（管理大块内存、灵活、容易内存泄漏）。</h4><p><strong>优势：</strong>灵活。<br><strong>劣势：</strong>需要程序员去处理工作细节，所以容易出错，严重依赖于程序员的水平。</p>
<h3 id="4-1-9-复杂数据结构"><a href="#4-1-9-复杂数据结构" class="headerlink" title="4.1.9.复杂数据结构"></a>4.1.9.复杂数据结构</h3><h4 id="4-1-9-1、链表、哈希表、二叉树、图等。"><a href="#4-1-9-1、链表、哈希表、二叉树、图等。" class="headerlink" title="4.1.9.1、链表、哈希表、二叉树、图等。"></a>4.1.9.1、链表、哈希表、二叉树、图等。</h4><p><strong>链表是最重要的：</strong>链表在Linux中使用特别多，在驱动和应用在编写时都需要使用链表，所以链表必须掌握。<br><strong>掌握到：</strong>会自己定义结构体来实现链表，会写链表的节点插入（前插、后插）、节点删除、节点查找、节点遍历。（至于像逆序这些很少用，掌握了前面那几个这个也不难）。</p>
<p>哈希表不是很常用，一般不需要自己实现，而直接使用别人实现的哈希表比较多。对我们来说重要明白哈希表原理，从而知道哈希表，当看到别人用了哈希表就要明白别人为什么要用哈希表，合适不合适？有没有更好的选择。</p>
<p>二叉树、图。对于这些复杂数据结构、不要太当回事。这些复制数据结构用到的概率很小（在嵌入式开发中），其实这些数据结构被发明出来就是为了解决特定的问题的，你不处理特定问题根本用不到这些，没必要去研究。                            </p>
<h4 id="4-1-9-2、为什么需要复杂的数据结构。"><a href="#4-1-9-2、为什么需要复杂的数据结构。" class="headerlink" title="4.1.9.2、为什么需要复杂的数据结构。"></a>4.1.9.2、为什么需要复杂的数据结构。</h4><p>因为现实中的问题是多种多样的，问题的复杂度不同需要解决的问题的算法和数据结构也不同的。<br>所以当你处理什么复杂度的问题，就去研究针对性解决问题的数据结构和算法；当你没有遇到此类问题（或者你工作的领域根本跟这个就没关系）时就不要管了。    </p>
<h4 id="4-1-9-3、数据结构和算法的关系。"><a href="#4-1-9-3、数据结构和算法的关系。" class="headerlink" title="4.1.9.3、数据结构和算法的关系。"></a>4.1.9.3、数据结构和算法的关系。</h4><p>数据结构的发明都是为了配合一定的算法；算法是为了处理具体问题，算法的实现依赖于相应的数据结构。</p>
<p>当前我们说的算法和纯数学是不同的（算法是基于数学，大学计算机系研究生博士很多本科都是数学相关专业的），因为计算机算法要求以数学为指导，并且结合计算机本身的特点来改进，最终实现一个在计算机上可以运行的算法（意思就是用代码可以表示的算法）。</p>
<h4 id="4-1-9-4、应该怎样学习这部分。"><a href="#4-1-9-4、应该怎样学习这部分。" class="headerlink" title="4.1.9.4、应该怎样学习这部分。"></a>4.1.9.4、应该怎样学习这部分。</h4><p><strong>从上面表述大家应该明白以下事实：</strong><br>(1)、数据结构和算法是相辅相成的，要一起研究。<br>(2)、数据结构和算法来说不全是重点，不要盲目的跑去研究这个。<br>(3)、一般在实际应用中，实现数据结构和算法的人和使用数据结构和算法的人是分开的。实际中一部分人的工作就是研究数据结构算法，并且试图用代码来实现这些算法（表现为库）；<br>                        其他做真正工作的人要做的就是理解、明白这些算法和数据结构的意义、优劣、特征、然后在合适的时候选择合适的数据结构和算法来解决自己碰到的实际问题。</p>
<p><strong>例子：</strong>Linux内核在字符设备驱动管理时，使用了哈希表（hash table，散列表）。所以字符设备驱动的很多特点都和哈希表的特点有关。            </p>
<h2 id="第二节-4-2-C语言位操作。"><a href="#第二节-4-2-C语言位操作。" class="headerlink" title="第二节    4.2.C语言位操作。"></a>第二节    4.2.C语言位操作。</h2><h2 id="第三节-4-3-指针才是C的精髓。"><a href="#第三节-4-3-指针才是C的精髓。" class="headerlink" title="第三节    4.3.指针才是C的精髓。"></a>第三节    4.3.指针才是C的精髓。</h2><h2 id="第四节-4-4-C语言复杂表达式与指针高级应用。"><a href="#第四节-4-4-C语言复杂表达式与指针高级应用。" class="headerlink" title="第四节    4.4.C语言复杂表达式与指针高级应用。"></a>第四节    4.4.C语言复杂表达式与指针高级应用。</h2><h2 id="第五节-4-5-数组-amp-字符串-amp-结构体-amp-共用体-amp-枚举。"><a href="#第五节-4-5-数组-amp-字符串-amp-结构体-amp-共用体-amp-枚举。" class="headerlink" title="第五节    4.5.数组&amp;字符串&amp;结构体&amp;共用体&amp;枚举。"></a>第五节    4.5.数组&amp;字符串&amp;结构体&amp;共用体&amp;枚举。</h2><h2 id="第六节-4-6-C语言宏定义与预处理、函数和函数库。"><a href="#第六节-4-6-C语言宏定义与预处理、函数和函数库。" class="headerlink" title="第六节    4.6.C语言宏定义与预处理、函数和函数库。"></a>第六节    4.6.C语言宏定义与预处理、函数和函数库。</h2><h2 id="第七节-4-7-存储类-amp-作用域-amp-生命周期-amp-链接属性。"><a href="#第七节-4-7-存储类-amp-作用域-amp-生命周期-amp-链接属性。" class="headerlink" title="第七节    4.7.存储类&amp;作用域&amp;生命周期&amp;链接属性。"></a>第七节    4.7.存储类&amp;作用域&amp;生命周期&amp;链接属性。</h2><h2 id="第八节-4-8-一些杂散但值得讨论的问题。"><a href="#第八节-4-8-一些杂散但值得讨论的问题。" class="headerlink" title="第八节    4.8.一些杂散但值得讨论的问题。"></a>第八节    4.8.一些杂散但值得讨论的问题。</h2><h2 id="第九节-4-9-链表-amp-状态机与多线程。"><a href="#第九节-4-9-链表-amp-状态机与多线程。" class="headerlink" title="第九节    4.9.链表&amp;状态机与多线程。"></a>第九节    4.9.链表&amp;状态机与多线程。</h2><h2 id="第十节-4-10-番外篇-程序员和编译器之间的暧昧。"><a href="#第十节-4-10-番外篇-程序员和编译器之间的暧昧。" class="headerlink" title="第十节    4.10.番外篇-程序员和编译器之间的暧昧。"></a>第十节    4.10.番外篇-程序员和编译器之间的暧昧。</h2>
                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">baiziqing</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://example.com/2021/11/01/linuxc-yu-yan-gao-ji-zhuan-ti/">http://example.com/2021/11/01/linuxc-yu-yan-gao-ji-zhuan-ti/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">baiziqing</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力!</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    
        <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }

    #vcomments textarea {
        box-sizing: border-box;
        background: url("/medias/comment_bg.png") 100% 100% no-repeat;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #4cbf30;
        font-weight: 500;
        text-decoration: none;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="vcomments" class="card-content" style="display: grid">
    </div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="/libs/valine/Valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        appId: 'RI3egRclleOHHB1LsfdoUakd-gzGzoHsz',
        appKey: 'H9wmIhcjdndlbjsdvwKY07yB',
        notify: 'false' === 'true',
        verify: 'false' === 'true',
        visitor: 'true' === 'true',
        avatar: 'mm',
        pageSize: '10',
        lang: 'zh-cn',
        placeholder: 'just go go'
    });
</script>

<!--酷Q推送-->


    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2021/11/02/qt-gui-bian-cheng/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/0.jpg" class="responsive-img" alt="">
                        
                        <span class="card-title"></span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2021-11-02
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            baiziqing
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/11/01/di-0-bu-fen-qian-yan-ji-chu-yu-ke/">
                    <div class="card-image">
                        
                        <img src="/article/wallhaven-v9dr6p.jpg" class="responsive-img" alt="4.LinuxC语言高级专题 &lt;朱有鹏&gt;">
                        
                        <span class="card-title">4.LinuxC语言高级专题 &lt;朱有鹏&gt;</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-11-01
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/c%E8%AF%AD%E8%A8%80/" class="post-category">
                                    c语言
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('100')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'CODE' || selection.getRangeAt(0).commonAncestorContainer.nodeName === 'CODE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: 白子卿<br />'
            + '文章作者: baiziqing<br />'
            + '文章链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2021</span>
            
            <a href="/about" target="_blank">baiziqing</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                        class="white-color">39.3k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
                <span id="sitetime"> Loading ...</span>
                <script>
                    var calcSiteTime = function () {
                        var seconds = 1000;
                        var minutes = seconds * 60;
                        var hours = minutes * 60;
                        var days = hours * 24;
                        var years = days * 365;
                        var today = new Date();
                        var startYear = "2021";
                        var startMonth = "10";
                        var startDate = "23";
                        var startHour = "0";
                        var startMinute = "0";
                        var startSecond = "0";
                        var todayYear = today.getFullYear();
                        var todayMonth = today.getMonth() + 1;
                        var todayDate = today.getDate();
                        var todayHour = today.getHours();
                        var todayMinute = today.getMinutes();
                        var todaySecond = today.getSeconds();
                        var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                        var diff = t2 - t1;
                        var diffYears = Math.floor(diff / years);
                        var diffDays = Math.floor((diff / days) - diffYears * 365);

                        // 区分是否有年份.
                        var language = 'zh-CN';
                        if (startYear === String(todayYear)) {
                            document.getElementById("year").innerHTML = todayYear;
                            var daysTip = 'This site has been running for ' + diffDays + ' days';
                            if (language === 'zh-CN') {
                                daysTip = '本站已运行 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                daysTip = '本站已運行 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = daysTip;
                        } else {
                            document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                            var yearsAndDaysTip = 'This site has been running for ' + diffYears + ' years and '
                                + diffDays + ' days';
                            if (language === 'zh-CN') {
                                yearsAndDaysTip = '本站已运行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                yearsAndDaysTip = '本站已運行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = yearsAndDaysTip;
                        }
                    }

                    calcSiteTime();
                </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/baiziqing" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1807230464@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1807230464" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1807230464" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/codeBlock/codeBlockFuction.js"></script>
    <script src="/libs/codeBlock/codeCopy.js"></script>
    <script src="/libs/codeBlock/codeLang.js"></script>
    <script src="/libs/codeBlock/codeShrink.js"></script>
    <script src="/live2d-widget/autoload.js"></script>
    <script src="/js/lihua.js"></script>
    <script src="/js/cursor.js"></script>

    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

    <!-- 天气接口 -->
    
        <!-- 天气接口-->
<script type="text/javascript">
    WIDGET = {FID: '1tFpFZ5Mtj'}
  </script>
<script type="text/javascript">
    //只在桌面版网页启用特效
    var windowWidth = $(window).width();
    if (windowWidth > 768) {
        document.write('<script type="text/javascript" src="https://apip.weatherdt.com/float/static/js/r.js?v=1111"><\/script>');
        }
  </script>

    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    
    
    <script type="text/javascript" size="150" alpha='0.6'
        zIndex="-1" src="/libs/background/ribbon-refresh.min.js" async="async"></script>
    

    
    <script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async="async"></script>
    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
